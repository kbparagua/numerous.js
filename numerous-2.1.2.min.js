// Numerous.js
// Unobtrusive Javascript helper for dynamically creating fields_for objects for Rails.
// Version 2.1.2
//
// Author: Karl Bryan Paragua
// Source: https://github.com/kbparagua/numerous.js
$(document).ready(function(){Numerous={init:function(b){var d=$(".numerous");Numerous.addFormHash={};Numerous.options=b||{};var a=0;for(b=d.length;a<b;a++){var c=$(d[a]),h=c.attr("id"),e=h.replace(/fields-for-/,""),f="add-to-"+e,j="#"+e,g=Numerous.options[e];c.removeClass("numerous").attr("id","");var k=$("<div></div>").append(c);Numerous.addFormHash[f]={form:k.html(),"fields-for":h,"update-div":j,list:e};c.remove();Numerous.clickHandlerForAdd(f);Numerous.createHandlersForRemove(e);if(g){a=g.initial;
f=$("#"+f);c=a;"function"===typeof a&&(c=a());for(a=0;a<c;a++)f.trigger("click");(g=g["after-initialize"])&&g()}}},clickHandlerForAdd:function(b){$("#"+b).click(function(b){b.preventDefault();var a=Numerous.addFormHash[this.id],c=(new Date).getTime();b=a.form.replace(/replace_this/g,c);b=$(b);b.addClass(a["fields-for"]);namePrefix=b.find("[name*="+c+"]:first").attr("name").match(RegExp("^(\\[|\\]|\\w|\\s|-)+\\["+c+"\\]"))[0];removeInputName=namePrefix+"[_destroy]";removeInput=$('<input type="hidden" value="0" class="numerous-remove-field" name="'+
removeInputName+'"/>');b.append(removeInput);$(a["update-div"]).append(b);if(a=Numerous.options[a.list])(a=a.add)&&a(b)})},createHandlersForRemove:function(b){var d=".fields-for-"+b+" .numerous-remove";$("body").off("click",d);$("body").on("click",d,function(a){a.preventDefault();var c=$(this);a=c.parent().closest(".fields-for-"+b);c=c.siblings(".numerous-remove-field:first");if(0==c.length){var d=a.find('input[name*="[id]"]:first');0==d.length?a.remove():(c=d.attr("name").replace("[id]","")+"[_destroy]",
c=$('<input type="hidden" value="0"class="numerous-remove-field" name="'+c+'"/>'),a.append(c))}c.attr("value","1");a.removeClass("fields-for-"+b);a.hide();if(c=Numerous.options[b])(c=c.remove)&&c(a)})},count:function(b){return $(".fields-for-"+b).length},get:function(b){return $(".fields-for-"+b)},removeAll:function(b){Numerous.get(b).find(".numerous-remove").trigger("click")}}});
